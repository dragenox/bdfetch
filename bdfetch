#!/bin/sh

GREEN='\033[32m'
PURPLE='\033[35m'
CYAN='\033[36m'
RESET='\033[0m'

show_system() {
    printf "%b" "$GREEN"
    cat <<'EOF'
  _     _
 | |   (_)
 | |__  _ __________ _
 | '_ \| |_  /_  / _` |
 | |_) | |/ / / / (_| |
 |_.__/|_/___/___\__,_|
EOF
    printf "%b" "$RESET"

    printf "%b" "$PURPLE"
    cat <<'EOF'
      _      _
     | |    (_)
   __| |_ __ ___   _____
  / _` | '__| \ \ / / _ \
 | (_| | |  | |\ V /  __/
  \__,_|_|  |_| \_/ \___|
EOF
    printf "%b\n" "$RESET"

    echo "Hostname: $(hostname)"
    echo "OS: bizza drive • $(. /etc/os-release && echo "$PRETTY_NAME")"
    echo "Kernel: $(uname -r)"
    echo "Uptime: $(uptime -p)"
    echo "CPU: $(lscpu | awk -F: '/Model name/ {sub(/^[ \t]+/, "", $2); print $2}')"
    echo "Memory: $(free -h | awk '/Mem:/ {print $3 "/" $2}')"
    echo "Disk: $(df -h / | awk 'NR==2 {print $3 "/" $2}')"
    echo "IP: $(hostname -I | awk '{print $1}')"
    echo "Powered by: OpenMediaVault ♥ open-source software"
    echo
}

show_disks() {
    printf "%b\n" "${CYAN}Disk layout:${RESET}"
    lsblk -o NAME,SIZE,TYPE,TRAN,FSTYPE,LABEL,UUID,FSUSE%,MOUNTPOINT,MODEL
    echo
}

usage() {
    cat <<EOF
Usage: bdfetch [OPTION]

Options:
  -s        System information (default)
  -d        Disk information
  -h        Show this help

Examples:
  bdfetch
  bdfetch -s
  bdfetch -d
EOF
}

# -------- argument handling --------

case "$1" in
    ""|"-s")
        show_system
        ;;
    "-d")
        show_disks
        ;;
    "-h"|"--help")
        usage
        ;;
    *)
        echo "Unknown option: $1"
        usage
        exit 1
        ;;
esac